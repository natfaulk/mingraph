Mingraphing=function(t,h){this._options={chartWidth:800,chartHeight:600,chartMargin:10,numberOfCharts:1,drawMargins:!0,type:"line",bipolar:!1,tooltip:!0};for(var i in h)this._options[i]=h[i];this.graphs={dataset:[],colors:[],keys:[],labels:[],chartNumbers:[],maxVals:[]},this.d=new Mindrawingjs;var s=this._options.numberOfCharts*(this._options.chartHeight+this._options.chartMargin)+this._options.chartMargin;if(this.d.setup(t,this._options.chartWidth,s),this.d.background("#000"),this._options.drawMargins&&this._drawMargins(),this._options.tooltip){var a=this;document.onmousemove=function(t){a.graphs.dataset.length>0&&(a.draw(),a.drawTooltip(t.pageX,t.pageY))}}},Mingraphing.prototype._drawMargins=function(){this.d.stroke("#FFFFFF");for(var t=0,h=0;h<this._options.numberOfCharts;h++)t+=this._options.chartMargin,this.d.line(0,t,this.d.width,t),t+=this._options.chartHeight,this.d.line(0,t,this.d.width,t)},Mingraphing.prototype.addData=function(t,h,i,s,a,r){this.graphs.colors.push(i),this.graphs.keys.push(h),this.graphs.labels.push(r),this.graphs.chartNumbers.push(s),this.graphs.maxVals.push(a);for(var o=0;o<t.length;o++)o>=this.graphs.dataset.length&&this.graphs.dataset.push({}),this.graphs.dataset[o][h]=t[o][h];this.draw()},Mingraphing.prototype.draw=function(){this.clear();for(var t=0;t<this.graphs.keys.length;t++)"line"==this._options.type?this._drawLine(this.graphs.dataset,this.graphs.keys[t],this.graphs.colors[t],this.graphs.chartNumbers[t],this.graphs.maxVals[t]):"bar"==this._options.type&&this._drawBar(this.graphs.dataset,this.graphs.keys[t],this.graphs.colors[t],this.graphs.chartNumbers[t],this.graphs.maxVals[t])},Mingraphing.prototype.drawTooltip=function(t,h){var i=t;i>1e3&&(i-=150);var s=Math.round(this.graphs.dataset.length/this._options.chartWidth*t);s>=this.graphs.dataset.length&&(s=this.graphs.dataset.length-1),this.d.stroke("#FFFFFF"),this.d.line(t,0,t,this._options.numberOfCharts*(this._options.chartHeight+this._options.chartMargin)+this._options.chartMargin),this.d.textSize(20),this.d.fill("#FFFFFF"),this.d.text("X: "+s,i+5,h+25);for(var a=0;a<this.graphs.keys.length;a++)this.d.fill(this.graphs.colors[a]),this.d.text(this.graphs.labels[a]+": "+this.graphs.dataset[s][this.graphs.keys[a]],i+5,h+55+30*a)},Mingraphing.prototype._drawLine=function(t,h,i,s,a){var r=0,o=0,n=0,e=0,p=this._options;this.d.stroke(i);for(var g=1;g<t.length;g++)t_ycom=s*(p.chartHeight+p.chartMargin)+p.chartMargin+p.chartHeight/2,p.bipolar||(t_ycom+=p.chartHeight/2),r=p.chartWidth*(g-1)/t.length,o=p.chartWidth*g/t.length,n=t_ycom-t[g-1][h]/a*p.chartHeight,e=t_ycom-t[g][h]/a*p.chartHeight,this.d.line(r,n,o,e)},Mingraphing.prototype._drawBar=function(t,h,i,s,a){var r=0,o=0,n=0,e=this._options;this.d.stroke(i);for(var p=0;p<t.length;p++)t_ycom=s*(e.chartHeight+e.chartMargin)+e.chartMargin+e.chartHeight/2,e.bipolar||(t_ycom+=e.chartHeight/2),r=e.chartWidth*p/t.length,o=t_ycom-t[p][h]/a*e.chartHeight,n=t_ycom,this.d.line(r,o,r,n)},Mingraphing.prototype.clear=function(){this.d.background("#000"),this._options.drawMargins&&this._drawMargins()},Mingraphing.prototype.tooltipEnabled=function(t){this._options.tooltip=t},"undefined"!=typeof module&&module.exports&&(module.exports=Mingraphing);